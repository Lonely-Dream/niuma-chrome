<!DOCTYPE html>
<html>
<head>
<style>
.title {
    font-size: 30px;
    text-align: center;
    color: rgb(33, 183, 65);
    border-bottom: 4px solid;
}
.slogan {
    text-align: center;
    font-style: italic;
    color: gray;
}
.box {
    margin: 20px auto;
    width: 300px;
    padding: 20px;
    border: 1px solid #30f033;
    border-radius: 5px;
    text-align: center;
    color: rgb(33, 183, 65);
}
.config {
    margin: 20px auto;
    width: 300px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 5px;
    text-align: center;
}
.process-bar-container {
    width: 100%;
    background-color: #f3f3f3;
    border-radius: 5px;
    overflow: hidden;
    margin-top: 10px;
}
.process-bar {
    height: 20px;
    width: 0;
    background-color: #4caf50;
    transition: width 0.1s ease-in-out;
}
</style>
</head>
<body>
    <div class="title">牛马加油站</div>
    <div id="slogan" class="slogan"></div>
    <div class="box">
        <div>
            <span>实时进账</span><span id="current-income">0.00</span>
        </div>
        <div class="process-bar-container">
            <span class="process-bar"></span><span id="process-value">0%</span>
        </div>
    </div>
    <div class="box">
        <div>
            <span>今日到手</span><span id="daily-income">0.00</span>
        </div>
        <div>
            <span>下班倒计时</span><span id="countdown">00:00:00</span>
        </div>
    </div>
    <div id="config" class="config" style="display: none;">
        <input type="number" id="salary" placeholder="请输入月薪">
        <input type="time" id="start-time">
        <input type="time" id="end-time">
        <button id="update" onclick="onUpdateConfig()">保存</button>
    </div>
    <div class="box">
        <button id="reset" onclick="onConfig()">配置草料信息</button>
    </div>
<script type="text/javascript">
const slogans = [
    "牛不哞，马不嘶，小小牛马，收到收到",
    "加班如饮水，摸鱼是刚需",
    "牛马望星辰，明日准点起",
    "千里马常有，加班费难求",
    "草料若管够，夜班也温柔"
];
const sloganElement = document.getElementById("slogan");
const configElement = document.getElementById("config");
const salaryElement = document.getElementById("salary");
const startTimeElement = document.getElementById("start-time");
const endTimeElement = document.getElementById("end-time");

let config = {
    salary: 99999,
    startTime: "09:00",
    endTime: "18:00"
};

// 初始化
// 设置第一条随机标语
sloganElement.innerHTML = slogans[Math.floor(Math.random() * slogans.length)];
// 加载配置
loadConfig();
salaryElement.value = config.salary;
startTimeElement.value = config.startTime;
endTimeElement.value = config.endTime;

setInterval(() => {
    sloganElement.innerHTML = slogans[Math.floor(Math.random() * slogans.length)];
}, 3000);

const countdownTimer = setInterval(onCountdownTimer, 100);

function saveConfig() {
    config.salary = parseFloat(salaryElement.value) || 0;
    config.startTime = startTimeElement.value;
    config.endTime = endTimeElement.value;
    localStorage.setItem("config", JSON.stringify(config));
}

function loadConfig() {
    const strConfig = localStorage.getItem("config");
    if (strConfig) {
        config = JSON.parse(strConfig);
    }
}

function calculateDailySalary(monthlySalary) {
    const workDaysInMonth = getWorkDaysInMonth(new Date());
    return monthlySalary / workDaysInMonth;
}

function getWorkDaysInMonth(date) {
    let count = 0;
    const year = date.getFullYear();
    const month = date.getMonth();
    const daysInMonth = new Date(year, month + 1, 0).getDate();

    for (let day = 1; day <= daysInMonth; day++) {
        const currentDate = new Date(year, month, day);
        if (currentDate.getDay() !== 0 && currentDate.getDay() !== 6) { // Monday to Friday
            count++;
        }
    }
    return count;
}

function onCountdownTimer() {
    const now = new Date();
    const [startHours, startMinutes] = config.startTime.split(':').map(Number);
    const [endHours, endMinutes] = config.endTime.split(':').map(Number);

    const startTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), startHours, startMinutes);
    const endTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), endHours, endMinutes);

    let currentIncome = 0;
    let progressValue = 0;

    if (now >= startTime && now <= endTime) {
        const dailySalary = calculateDailySalary(config.salary);
        const workDurationInSeconds = (endTime - startTime) / 1000;
        const incomePerSecond = dailySalary / workDurationInSeconds;

        const elapsedSeconds = (now - startTime) / 1000;
        currentIncome = Math.round(incomePerSecond * elapsedSeconds * 100) / 100;
        progressValue = ((elapsedSeconds / workDurationInSeconds) * 100).toFixed(2);

        document.getElementById('current-income').textContent = currentIncome.toFixed(2);
        document.getElementById('process-value').textContent = `${progressValue}%`;
        document.querySelector('.process-bar').style.width = `${progressValue}%`;

        const timeLeft = Math.max(0, Math.ceil((endTime - now) / 1000));
        const hours = Math.floor(timeLeft / 3600);
        const minutes = Math.floor((timeLeft % 3600) / 60);
        const seconds = timeLeft % 60;
        document.getElementById('countdown').textContent = 
            `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    } else {
        document.getElementById('current-income').textContent = '0.00';
        document.getElementById('process-value').textContent = '0%';
        document.querySelector('.process-bar').style.width = '0%';
        document.getElementById('countdown').textContent = '00:00:00';
    }

    // Update daily income based on daily salary
    const dailySalary = calculateDailySalary(config.salary);
    document.getElementById('daily-income').textContent = dailySalary.toFixed(2);
}

function onConfig() {
    configElement.style.display = "block";
}

function onUpdateConfig() {
    saveConfig();
    configElement.style.display = "none";
}

</script>
</body>
</html>



